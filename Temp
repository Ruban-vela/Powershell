index=winserver_process splunk_server_group=* instance=System earliest=-7d latest=now
[ | inputlookup backupreport_web.csv where backup_enabled="YES"
  | rename Hostname as host
  | fields host ]
| stats latest(_time) as last_log_time by host
| append [
    | inputlookup backupreport_web.csv where backup_enabled="YES"
    | rename Hostname as host
    | eval last_log_time=null()
]
| stats max(last_log_time) as last_log_time by host
| eval minutes_ago = round((now() - last_log_time)/60)
| eval check = case(
    isnull(last_log_time), "DOWN",
    minutes_ago > 5, "HUNG",
    true(), "GOOD"
)
| eval last_log_time = strftime(last_log_time,"%Y-%m-%d %H:%M:%S")
| table host last_log_time minutes_ago check
| sort host
